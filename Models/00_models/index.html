
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../Guidance/01_cfg/">
      
      
        <link rel="next" href="../01_diffusion/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>What is a Model? - 11yu on Tech For AI Image Generation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-is-a-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="11yu on Tech For AI Image Generation" class="md-header__button md-logo" aria-label="11yu on Tech For AI Image Generation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            11yu on Tech For AI Image Generation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              What is a Model?
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="11yu on Tech For AI Image Generation" class="md-nav__button md-logo" aria-label="11yu on Tech For AI Image Generation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    11yu on Tech For AI Image Generation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guidance
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Guidance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Guidance/00_guidance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Guidance?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Guidance/01_cfg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CFG
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    What is a Model?
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    What is a Model?
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-does-generating-mean" class="md-nav__link">
    <span class="md-ellipsis">
      What Does "Generating" Mean?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What Does &#34;Generating&#34; Mean?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#p_textdata-for-images" class="md-nav__link">
    <span class="md-ellipsis">
      \(p_\text{data}\) for Images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-modeling-p_textdata-is-a-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Why Modeling \(p_\text{data}\) is a Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-loss-function" class="md-nav__link">
    <span class="md-ellipsis">
      What is a Loss Function?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What is a Loss Function?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-adversarial-loss" class="md-nav__link">
    <span class="md-ellipsis">
      What is Adversarial Loss?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_diffusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A Premier on Diffusion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_training_objectives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training Diffusion Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_vae/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VAE (Variational AutoEncoder)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../99_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Additional Notes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sampling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Sampling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sampling/00_sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Sampling?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sampling/01_accuracy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    "Accuracy / Control"
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sampling/03_sample_speed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation Speed and How to Go Faster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sampling/04_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Types of Sampling Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sampling/05_training_free_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    (Non-exhaustive) List of Training-Free Samplers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sampling/06_training_based_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    (Non-exhaustive) List of Training-Based Sampling Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sampling/07_tldr_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Practical TL;DR of Samplers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Schedule
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Schedule/00_schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is a Noise Schedule?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Schedule/01_schedule_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    (Non-exhaustive) List of Schedulers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Appendix/other_guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other Guides
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Appendix/references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Appendix/special_thanks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Special Thanks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-does-generating-mean" class="md-nav__link">
    <span class="md-ellipsis">
      What Does "Generating" Mean?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What Does &#34;Generating&#34; Mean?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#p_textdata-for-images" class="md-nav__link">
    <span class="md-ellipsis">
      \(p_\text{data}\) for Images
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-modeling-p_textdata-is-a-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Why Modeling \(p_\text{data}\) is a Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-loss-function" class="md-nav__link">
    <span class="md-ellipsis">
      What is a Loss Function?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What is a Loss Function?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-adversarial-loss" class="md-nav__link">
    <span class="md-ellipsis">
      What is Adversarial Loss?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="what-is-a-model">What is a Model?</h1>
<p>A <strong>generative model</strong> learns to create new data similar to the training data. This is in contrast to a <strong>discriminatory model</strong> which learns to look at a new data point and predict a label or number. For images, you can imagine that:</p>
<ul>
<li>generative model: learns to make new images</li>
<li>discriminatory model: learns to classify it as cat or dog / predict auction price</li>
</ul>
<p>In modern day, generative models are usually deep neural networks, including GANs, VAEs, and of course diffusion models.</p>
<h2 id="what-does-generating-mean">What Does "Generating" Mean?</h2>
<p>Researchers mathematically formalize the idea of generating data as sampling from a <strong>probability distribution <span class="arithmatex">\(p_\text{data}\)</span>.</strong> A probability distribution is just something that assigns each possible outcome of an event with the chance of it happening. More specifically, <span class="arithmatex">\(p_\text{data}\)</span> is a function that takes in a data point and gives you how likely it is to occur.</p>
<div class="admonition note">
<p class="admonition-title">Illustrative Example</p>
<p>Imagine rolling a fair die. The possible outcomes are one of the 6 faces, with a number 1-6 on that side. The probability of each outcome is equal. The probability distribution of the dice roll <span class="arithmatex">\(p_\text{dice}\)</span> could thus be described as the following table:</p>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(\text{roll}\)</span></th>
<th><span class="arithmatex">\(1\)</span></th>
<th><span class="arithmatex">\(2\)</span></th>
<th><span class="arithmatex">\(3\)</span></th>
<th><span class="arithmatex">\(4\)</span></th>
<th><span class="arithmatex">\(5\)</span></th>
<th><span class="arithmatex">\(6\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(p_\text{dice}(\text{roll})\)</span></td>
<td><span class="arithmatex">\(\frac16\)</span></td>
<td><span class="arithmatex">\(\frac16\)</span></td>
<td><span class="arithmatex">\(\frac16\)</span></td>
<td><span class="arithmatex">\(\frac16\)</span></td>
<td><span class="arithmatex">\(\frac16\)</span></td>
<td><span class="arithmatex">\(\frac16\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>Let's say we try to generate cats. One can imagine there that there exists an underlying probability distribution, <span class="arithmatex">\(p_\text{CatImages},\)</span> which assigns a higher probability to natural cat images, and low probability for other images like dogs. If we can sample from <span class="arithmatex">\(p_\text{CatImages},\)</span> that's the same as being able to generate new, high quality cat images.</p>
<p>The goal of generative modeling can now be formalized as to allow us to sample from <span class="arithmatex">\(p_\text{data},\)</span> when <span class="arithmatex">\(p_\text{data}\)</span> itself could be extremely complicated.</p>
<h3 id="p_textdata-for-images"><span class="arithmatex">\(p_\text{data}\)</span> for Images</h3>
<p>Imagine 2x2 images with 1 grayscale channel, where the channel value goes from 0-255. Each image can be thought of as a <span class="arithmatex">\(2\times2\times1\)</span> list of numbers. For example, this could be a black and white image where the top left pixel has brightness 100, bottom right 200, and the rest completely dark:</p>
<p><span class="arithmatex">\(\begin{bmatrix}[100] &amp; [0] \\ [0] &amp; [200]\end{bmatrix}\)</span></p>
<p>We can also assign each image with a probability, thus creating a probability distribution for images:</p>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(\text{Image}\)</span></th>
<th><span class="arithmatex">\(\begin{bmatrix}[100] &amp; [0] \\ [0] &amp; [200]\end{bmatrix}\)</span></th>
<th><span class="arithmatex">\(\begin{bmatrix}[42] &amp; [0] \\ [0] &amp; [42]\end{bmatrix}\)</span></th>
<th>...</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(p_\text{data}(\text{Image})\)</span></td>
<td><span class="arithmatex">\(\frac1{1234}\)</span></td>
<td><span class="arithmatex">\(\frac{11}{1337}\)</span></td>
<td>...</td>
</tr>
</tbody>
</table>
<p>Real world images are obviously more complex, having way bigger widths and heights, and having multiple color channels like RGB, resulting in <span class="arithmatex">\(W\times H\times 3\)</span> list of numbers. However, the principles stay fundamentally the same. </p>
<h3 id="why-modeling-p_textdata-is-a-problem">Why Modeling <span class="arithmatex">\(p_\text{data}\)</span> is a Problem</h3>
<p>Great! So, just train a neural network to learn <span class="arithmatex">\(p_\text{data},\)</span> right? Well... it's not so easy. To see why, let's try designing a neural network that represents a probability distribution. </p>
<p>Let's call our neural network <span class="arithmatex">\(\text{NN}(\text{Input}),\)</span> and let's call the distribution that <span class="arithmatex">\(\text{Input}\)</span> comes from <span class="arithmatex">\(p_\text{init}.\)</span> <span class="arithmatex">\(p_\text{init}\)</span> can pretty much be anything; You could for example train a neural network to turn cat images into dog images if you really wanted to.</p>
<p>In practice, <span class="arithmatex">\(p_\text{init}\)</span> is usually the <strong>gaussian</strong> distribution, aka the <strong>noise</strong> distribution. The benefit is that the gaussian is very simple, and we know how generate infinite samples from it. So if our neural network learns to turn <span class="arithmatex">\(p_\text{init}\to p_\text{data},\)</span> <em>and</em> we know how to generate infinite samples of <span class="arithmatex">\(p_\text{init},\)</span> we can now generate infinite samples of <span class="arithmatex">\(p_\text{data}.\)</span> Neat!</p>
<div class="admonition note">
<p class="admonition-title">Assumptions</p>
<p>Since it's almost always the case that <span class="arithmatex">\(p_\text{init}\)</span> is the gaussian, I'll be making this assumption in this guide from here on.</p>
</div>
<p>Since our outputs should be probabilities, these outputs should all be positive, as negative probability doesn't really make sense, right? A conventional way to do this is to transform the output using the exponential function, i.e. turn it into <span class="arithmatex">\(e^{-\text{NN}(\text{Input})}.\)</span> The details are mathy, but the important part is that <span class="arithmatex">\(e^{-\text{NN}(\text{Input})}\)</span> is always positive.</p>
<p>Next, recall that <span class="arithmatex">\(p_\text{data}\)</span> gives you the chance of a specific outcome of an event. Thus, we should expect that the <em>sum</em> of all these chances - that there being <em>an</em> outcome, <em>any</em> outcome - be 1. To do this, we can divide our outputs by a magical constant <span class="arithmatex">\(Z\)</span>. Our output is now <span class="arithmatex">\(\frac{e^{-\text{NN}(\text{Input})}}Z.\)</span> <span class="arithmatex">\(Z\)</span> is called the <strong>normalizing constant</strong> in literature.</p>
<p>To recap:</p>
<ul>
<li>Neural network outputs <span class="arithmatex">\(\text{NN}(\text{Input})\)</span> which should be similar to <span class="arithmatex">\(p_\text{data},\)</span> where <span class="arithmatex">\(\text{Input}\)</span> comes from some initial distribution <span class="arithmatex">\(p_\text{init},\)</span> usually the gaussian (the noise distribution).</li>
<li>Probabilities should be positive, so we instead use <span class="arithmatex">\(e^{-\text{NN}(\text{Input})}\)</span> as the output</li>
<li>The sum of probabilities should be 1, so we instead use <span class="arithmatex">\(\frac{e^{-\text{NN}(\text{Input})}}Z\)</span> as the output</li>
</ul>
<p>The problem lies in <span class="arithmatex">\(Z,\)</span> which is next to impossible to calculate for a general neural network. People have come up with ways around this of course. Approaches prior to diffusion can be split into 3 categories, referencing <a href="https://www.youtube.com/watch?v=wMmqCMwuM2Q">this talk</a> / <a href="https://yang-song.net/blog/2021/score/">blog</a> by Yang Song, one of the pioneers of modern diffusion:</p>
<ol>
<li><strong>Approximate <span class="arithmatex">\(Z\)</span>:</strong> Calculating <span class="arithmatex">\(Z\)</span> exactly is hard, so just use an approximation. One problem is this approximation is <em>still</em> expensive to calculate.</li>
<li><strong>Restrict the Neural Network:</strong> Restrict the neural network to specific architectures so <span class="arithmatex">\(Z\)</span> can be calculated. Obviously this limits our freedom in designing the neural network. Examples include autoregressive models.</li>
<li><strong>Model the Generation Process Only:</strong> Skip trying to model <span class="arithmatex">\(p_\text{data}\)</span> entirely, just model a process that can generate new data. This usually involves using adversarial loss, which is highly unstable and hard to train with, plus <a href="https://arxiv.org/abs/1706.08224">the result might deviate from <span class="arithmatex">\(p_\text{data}\)</span></a>. Examples include GANs.</li>
</ol>
<h2 id="what-is-a-loss-function">What is a Loss Function?</h2>
<p>At a high level, we always say we "train a model to learn something." Well... how do we quantify how much the model has "learned"?</p>
<p>The <strong>loss (function) <span class="arithmatex">\(L\)</span></strong>, also called the <strong>cost</strong> or <strong>objective</strong>, is a function people design to measure how well the model performs on a task. Conventionally, a lower loss means the model is performing better. Training a model could also be referred to as minimizing the loss.</p>
<div class="admonition note">
<p class="admonition-title">Illustrative Example</p>
<p>Let's say you're trying to predict house prices. A simple and common loss function for this task could be <span class="arithmatex">\(L=|\text{TruePrice} - \text{PredictedPrice}|^2\)</span>, the square of the difference between the true price and the predicted price. As you can imagine, trying to minimize the loss <span class="arithmatex">\(L\)</span> is the same as trying to reduce the difference between the true price and the prediction, or in other words make the prediction more accurate. </p>
</div>
<div class="admonition info">
<p class="admonition-title">Why Minimize the Square?</p>
<p>You may ask, why minimize the difference squared and not just the difference? An intuitive explanation is this: If the difference between the true price and the predicted price is big, then the square will extrapolate it to be bigger. This means we punish the model way harder if it makes a wildly inaccurate prediction.</p>
<p>There are more math-heavy reasons rooted in statistics, the details of which are out of the scope of this article. (For those interested in searchable keywords, minimizing the squared difference - the L2 loss - corresponds to maximizing the likelihood, under the assumption that the random errors are normally distributed.)</p>
</div>
<h3 id="what-is-adversarial-loss">What is Adversarial Loss?</h3>
<p><strong>Adversarial</strong> loss generally refers to when practitioners pit two neural networks against each other.</p>
<p>For example, in image genereating GANs, two models are simutaneously trained at once - the generator <span class="arithmatex">\(G\)</span>, and the discriminator / adversary <span class="arithmatex">\(A\)</span>:</p>
<ul>
<li><span class="arithmatex">\(G\)</span> tries its best to create realistic images and fool <span class="arithmatex">\(A\)</span>.</li>
<li>
<p><span class="arithmatex">\(A\)</span> tries its best to distinguish between real and generated images. 
This is a sound approach, and GANs have been SOTA in terms of generative modeling. It comes with its own problem though, most prominently that it's very hard to balance <span class="arithmatex">\(G\)</span> and <span class="arithmatex">\(A\)</span>. For example:</p>
</li>
<li>
<p><span class="arithmatex">\(G\)</span> only learns how to exploit <span class="arithmatex">\(A\)</span>'s defects, creating "images" that trick <span class="arithmatex">\(A\)</span> but are completely unnatural.</p>
</li>
<li><span class="arithmatex">\(G\)</span> only learns a few types of images that <span class="arithmatex">\(A\)</span> is less certain about, destroying output variety.</li>
<li><span class="arithmatex">\(A\)</span> is too good at discerning real vs. generated that makes it impossible for <span class="arithmatex">\(G\)</span> to learn from gradient descent.</li>
<li><span class="arithmatex">\(G\)</span> and <span class="arithmatex">\(A\)</span> end up in an infinite XYZ cycle. <span class="arithmatex">\(G\)</span> learns to generate only X, so <span class="arithmatex">\(A\)</span> learns to classify that as generated; <span class="arithmatex">\(G\)</span> then learns to only generate Y, so <span class="arithmatex">\(A\)</span> classifies all Y as generated, repeat.</li>
</ul>
<p>Several training rules, different types of losses, regularization techniques... have been proposed <em>just</em> to attempt to solve this problem in GANs.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>